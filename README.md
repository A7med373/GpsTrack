# Система отслеживания GPS

Система для отслеживания GPS-координат с 365gps.net и отображения их на карте.

## Установка

1. Откройте терминал. Клонируйте репозиторий. Создайте виртуальное окружение и активируйте его:

```bash
git clone https://github.com/A7med373/GpsTrack
cd GpsTrack
```

```bash
python -m venv .venv
source .venv/bin/activate  # На Windows: .venv\Scripts\activate
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите сборщик GPS-данных (в одном терминале):
```bash
python fetch_coords.py
```

4. Запустите веб-приложение (в другом терминале):
```bash
python app.py
```

5. Откройте браузер и перейдите по адресу `http://localhost:5000`

## Функции

- Автоматический сбор GPS-данных каждые 5 секунд
- Веб-интерфейс с интеграцией плана здания
- Обновление GPS-точек в реальном времени
- Подробные всплывающие окна с информацией для каждой точки
- Хранение данных в SQLite
- Фильтрация точек, находящихся вне здания
- Отображение точек из буферной зоны на ближайшей границе здания

## Конфигурация

Система использует следующую конфигурацию по умолчанию:
- IMEI: 861261027896790
- Пароль: 1234567
- FETCH_INTERVAL: 5 секунд (интервал обновления GPS-данных, его можно настроить в файле fetch_coords.py)
- GPS_BUFFER: 0.0003 градуса (примерно 30-40 метров, буферная зона вокруг здания для учета неточности GPS, ее можно настроить в map.js)

Для изменения этих значений измените константы в `fetch_coords.py`.

## База данных

Система использует SQLite со следующей схемой:
- Таблица: gps_points
  - id (Integer, Primary Key)
  - lat_google (Float) - широта
  - lng_google (Float) - долгота
  - imei (String) - идентификатор устройства
  - speed (Float) - скорость в км/ч
  - signal (DateTime) - время сигнала
  - timestamp (DateTime) - время записи
  - in_actual_building (Integer) - флаг, указывающий, находится ли точка внутри фактического здания (1) или в буферной зоне (0)

## Стек

Flask, APScheduler, SQLAlchemy, requests, python-dotenv, Jinja2
Leaflet, HTML, CSS, JavaScript